(function(g){var r,a=g.Axis,b=g.Chart,n=g.Point,o=g.Pointer,e=g.each,f=g.extend,i=g.merge,l=g.pick,k=g.numberFormat,d=g.getOptions(),p=g.seriesTypes,m=d.plotOptions,s=g.wrap,c=g.Color,j=function(){};function q(t,x,v){var u=4,w=[];while(u--){w[u]=Math.round(x.rgba[u]+(t.rgba[u]-x.rgba[u])*(1-v))}return"rgba("+w.join(",")+")"}d.mapNavigation={buttonOptions:{align:"right",verticalAlign:"bottom",x:0,width:18,height:18,style:{fontSize:"15px",fontWeight:"bold",textAlign:"center"}},buttons:{zoomIn:{onclick:function(){this.mapZoom(0.5)},text:"+",y:-32},zoomOut:{onclick:function(){this.mapZoom(2)},text:"-",y:0}}};g.splitPath=function(u){var t;u=u.replace(/([A-Za-z])/g," $1 ");u=u.replace(/^\s*/,"").replace(/\s*$/,"");u=u.split(/[ ,]+/);for(t=0;t<u.length;t++){if(!/[a-zA-Z]/.test(u[t])){u[t]=parseFloat(u[t])}}return u};g.maps={};s(a.prototype,"getSeriesExtremes",function(w){var v=this.isXAxis,u,t,x=[];e(this.series,function(z,y){if(z.useMapGeometry){x[y]=z.xData;z.xData=[]}});w.call(this);u=l(this.dataMin,Number.MAX_VALUE);t=l(this.dataMax,Number.MIN_VALUE);e(this.series,function(z,y){if(z.useMapGeometry){u=Math.min(u,z[v?"minX":"minY"]);t=Math.max(t,z[v?"maxX":"maxY"]);z.xData=x[y]}});this.dataMin=u;this.dataMax=t});s(a.prototype,"setAxisTranslation",function(z){var u=this.chart,w,y=u.plotWidth/u.plotHeight,v=this.isXAxis,t,A=u.xAxis[0],x;z.call(this);if(u.options.chart.type==="map"&&!v&&A.transA!==r){this.transA=A.transA=Math.min(this.transA,A.transA);w=(A.max-A.min)/(this.max-this.min);x=w>y?this:A;t=(x.max-x.min)*x.transA;x.minPixelPadding=(x.len-t)/2}});s(b.prototype,"render",function(v){var t=this,u=t.options.mapNavigation;v.call(t);t.renderMapNavigation();if(u.zoomOnDoubleClick){g.addEvent(t.container,"dblclick",function(w){t.pointer.onContainerDblClick(w)})}if(u.zoomOnMouseWheel){g.addEvent(t.container,document.onmousewheel===undefined?"DOMMouseScroll":"mousewheel",function(w){t.pointer.onContainerMouseWheel(w)})}});f(o.prototype,{onContainerDblClick:function(u){var t=this.chart;u=this.normalize(u);if(t.isInsidePlot(u.chartX-t.plotLeft,u.chartY-t.plotTop)){t.mapZoom(0.5,t.xAxis[0].toValue(u.chartX),t.yAxis[0].toValue(u.chartY))}},onContainerMouseWheel:function(v){var t=this.chart,u;v=this.normalize(v);u=v.detail||-(v.wheelDelta/120);if(t.isInsidePlot(v.chartX-t.plotLeft,v.chartY-t.plotTop)){t.mapZoom(u>0?2:0.5,t.xAxis[0].toValue(v.chartX),t.yAxis[0].toValue(v.chartY))}}});s(o.prototype,"init",function(v,t,u){v.call(this,t,u);if(u.mapNavigation.enableTouchZoom){this.pinchX=this.pinchHor=this.pinchY=this.pinchVert=true}});f(b.prototype,{renderMapNavigation:function(){var w=this,y=this.options.mapNavigation,v=y.buttons,x,t,u,z=function(){this.handler.call(w)};if(y.enableButtons){for(x in v){if(v.hasOwnProperty(x)){u=i(y.buttonOptions,v[x]);t=w.renderer.button(u.text,0,0,z).attr({width:u.width,height:u.height}).css(u.style).add();t.handler=u.onclick;t.align(f(u,{width:t.width,height:t.height}),null,"spacingBox")}}}},fitToBox:function(t,u){e([["x","width"],["y","height"]],function(v){var w=v[0],x=v[1];if(t[w]+t[x]>u[w]+u[x]){if(t[x]>u[x]){t[x]=u[x];t[w]=u[w]}else{t[w]=u[w]+u[x]-t[x]}}if(t[x]>u[x]){t[x]=u[x]}if(t[w]<u[w]){t[w]=u[w]}});return t},mapZoom:function(A,v,x){if(this.isMapZooming){return}var y=this,G=y.xAxis[0],H=G.max-G.min,u=l(v,G.min+H/2),D=H*A,I=y.yAxis[0],J=I.max-I.min,w=l(x,I.min+J/2),F=J*A,C=u-D/2,E=w-F/2,t=l(y.options.chart.animation,true),z,B=y.fitToBox({x:C,y:E,width:D,height:F},{x:G.dataMin,y:I.dataMin,width:G.dataMax-G.dataMin,height:I.dataMax-I.dataMin});G.setExtremes(B.x,B.x+B.width,false);I.setExtremes(B.y,B.y+B.height,false);z=t?t.duration||500:0;if(z){y.isMapZooming=true;setTimeout(function(){y.isMapZooming=false},z)}y.redraw()}});m.map=i(m.scatter,{animation:false,nullColor:"#F8F8F8",borderColor:"silver",borderWidth:1,marker:null,stickyTracking:false,dataLabels:{verticalAlign:"middle"},turboThreshold:0,tooltip:{followPointer:true,pointFormat:"{point.name}: {point.y}<br/>"},states:{normal:{animation:true}}});var h=g.extendClass(n,{applyOptions:function(t,v){var u=n.prototype.applyOptions.call(this,t,v);if(u.path&&typeof u.path==="string"){u.path=u.options.path=g.splitPath(u.path)}return u},onMouseOver:function(){clearTimeout(this.colorInterval);n.prototype.onMouseOver.call(this)},onMouseOut:function(){var x=this,y=+new Date(),w=c(x.options.color),v=c(x.pointAttr.hover.fill),t=x.series.options.states.normal.animation,u=t&&(t.duration||500);if(u&&w.rgba.length===4&&v.rgba.length===4){delete x.pointAttr[""].fill;clearTimeout(x.colorInterval);x.colorInterval=setInterval(function(){var A=(new Date()-y)/u,z=x.graphic;if(A>1){A=1}if(z){z.attr("fill",q(v,w,A))}if(A>=1){clearTimeout(x.colorInterval)}},13)}n.prototype.onMouseOut.call(x)}});p.map=g.extendClass(p.scatter,{type:"map",pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},colorKey:"y",pointClass:h,trackerGroups:["group","markerGroup","dataLabelsGroup"],getSymbol:j,supportsDrilldown:true,getExtremesFromAll:true,useMapGeometry:true,init:function(t){var C=this,G=t.options.legend.valueDecimals,A=[],B,v,E,w,F,u,H,y,x,D,z=t.options.legend.layout==="horizontal";g.Series.prototype.init.apply(this,arguments);u=C.options.colorRange;H=C.options.valueRanges;if(H){e(H,function(I){v=I.from;E=I.to;B="";if(v===r){B="< "}else{if(E===r){B="> "}}if(v!==r){B+=k(v,G)}if(v!==r&&E!==r){B+=" - "}if(E!==r){B+=k(E,G)}A.push(g.extend({chart:C.chart,name:B,options:{},drawLegendSymbol:p.area.prototype.drawLegendSymbol,visible:true,setState:function(){},setVisible:function(){}},I))});C.legendItems=A}else{if(u){v=u.from;E=u.to;w=u.fromLabel;F=u.toLabel;x=z?[0,0,1,0]:[0,1,0,0];if(!z){D=w;w=F;F=D}y={linearGradient:{x1:x[0],y1:x[1],x2:x[2],y2:x[3]},stops:[[0,v],[1,E]]};A=[{chart:C.chart,options:{},fromLabel:w,toLabel:F,color:y,drawLegendSymbol:this.drawLegendSymbolGradient,visible:true,setState:function(){},setVisible:function(){}}];C.legendItems=A}}},drawLegendSymbol:p.area.prototype.drawLegendSymbol,drawLegendSymbolGradient:function(z,y){var E=z.options.symbolPadding,A=l(z.options.padding,8),C,B,w=this.chart.renderer.fontMetrics(z.options.itemStyle.fontSize).h,x=z.options.layout==="horizontal",t,u,v,D=l(z.options.rectangleLength,200);if(x){C=-(E/2);B=0}else{C=-D+z.baseline-(E/2);B=A+w}y.fromText=this.chart.renderer.text(y.fromLabel,B,C).attr({zIndex:2}).add(y.legendGroup);t=y.fromText.getBBox();y.legendSymbol=this.chart.renderer.rect(x?t.x+t.width+E:t.x-w-E,t.y,x?D:w,x?w:D,2).attr({zIndex:1}).add(y.legendGroup);u=y.legendSymbol.getBBox();y.toText=this.chart.renderer.text(y.toLabel,u.x+u.width+E,x?C:u.y+u.height-E).attr({zIndex:2}).add(y.legendGroup);v=y.toText.getBBox();if(x){z.offsetWidth=t.width+u.width+v.width+(E*2)+A;z.itemY=w+A}else{z.offsetWidth=Math.max(t.width,v.width)+(E)+u.width+A;z.itemY=u.height+A;z.itemX=E}},getBox:function(x){var t=Number.MIN_VALUE,v=Number.MAX_VALUE,u=Number.MIN_VALUE,w=Number.MAX_VALUE;e(x||this.options.data,function(B){var A=B.path,z=A.length,y=false,C=Number.MIN_VALUE,E=Number.MAX_VALUE,D=Number.MIN_VALUE,F=Number.MAX_VALUE;while(z--){if(typeof A[z]==="number"&&!isNaN(A[z])){if(y){C=Math.max(C,A[z]);E=Math.min(E,A[z])}else{D=Math.max(D,A[z]);F=Math.min(F,A[z])}y=!y}}B._maxX=C;B._minX=E;B._maxY=D;B._minY=F;t=Math.max(t,C);v=Math.min(v,E);u=Math.max(u,D);w=Math.min(w,F)});this.minY=w;this.maxY=u;this.minX=v;this.maxX=t},translatePath:function(v){var w=this,t=false,x=w.xAxis,y=w.yAxis,u;v=[].concat(v);u=v.length;while(u--){if(typeof v[u]==="number"){if(t){v[u]=Math.round(x.translate(v[u]))}else{v[u]=Math.round(y.len-y.translate(v[u]))}t=!t}}return v},setData:function(){g.Series.prototype.setData.apply(this,arguments);this.getBox()},translate:function(){var v=this,u=Number.MAX_VALUE,t=Number.MIN_VALUE;v.generatePoints();e(v.data,function(w){w.shapeType="path";w.shapeArgs={d:v.translatePath(w.path)};if(typeof w.y==="number"){if(w.y>t){t=w.y}else{if(w.y<u){u=w.y}}}});v.translateColors(u,t)},translateColors:function(w,v){var y=this.options,A=y.valueRanges,u=y.colorRange,t=this.colorKey,x,z;if(u){x=c(u.from);z=c(u.to)}e(this.data,function(D){var G=D[t],F,B,C,E;if(A){C=A.length;while(C--){F=A[C];x=F.from;z=F.to;if((x===r||G>=x)&&(z===r||G<=z)){B=F.color;break}}}else{if(u&&G!==undefined){E=1-((v-G)/(v-w));B=G===null?y.nullColor:q(x,z,E)}}if(B){D.color=null;D.options.color=B}})},drawGraph:j,drawDataLabels:j,drawPoints:function(){var u=this,v=u.xAxis,w=u.yAxis,t=u.colorKey;e(u.data,function(x){x.plotY=1;if(x[t]===null){x[t]=0;x.isNull=true}});p.column.prototype.drawPoints.apply(u);e(u.data,function(C){var x=C.dataLabels,A=v.toPixels(C._minX,true),y=v.toPixels(C._maxX,true),B=w.toPixels(C._minY,true),z=w.toPixels(C._maxY,true);C.plotX=Math.round(A+(y-A)*l(x&&x.anchorX,0.5));C.plotY=Math.round(B+(z-B)*l(x&&x.anchorY,0.5));if(C.isNull){C[t]=null}});g.Series.prototype.drawDataLabels.call(u)},animateDrilldown:function(v){var y=this.chart.plotBox,w=this.chart.drilldownLevels[this.chart.drilldownLevels.length-1],u=w.bBox,t=this.chart.options.drilldown.animation,x;if(!v){x=Math.min(u.width/y.width,u.height/y.height);w.shapeArgs={scaleX:x,scaleY:x,translateX:u.x,translateY:u.y};e(this.points,function(z){z.graphic.attr(w.shapeArgs).animate({scaleX:1,scaleY:1,translateX:0,translateY:0},t)});delete this.animate}},animateDrillupFrom:function(t){p.column.prototype.animateDrillupFrom.call(this,t)},animateDrillupTo:function(t){p.column.prototype.animateDrillupTo.call(this,t)}});m.mapline=i(m.map,{lineWidth:1,backgroundColor:"none"});p.mapline=g.extendClass(p.map,{type:"mapline",pointAttrToOptions:{stroke:"color","stroke-width":"lineWidth",fill:"backgroundColor"},drawLegendSymbol:p.line.prototype.drawLegendSymbol});m.mappoint=i(m.scatter,{dataLabels:{enabled:true,format:"{point.name}",color:"black",style:{textShadow:"0 0 5px white"}}});p.mappoint=g.extendClass(p.scatter,{type:"mappoint"});g.Map=function(v,t){var u={endOnTick:false,gridLineWidth:0,labels:{enabled:false},lineWidth:0,minPadding:0,maxPadding:0,startOnTick:false,tickWidth:0,title:null},w;w=v.series;v.series=null;v=i({chart:{type:"map",panning:"xy"},xAxis:u,yAxis:i(u,{reversed:true})},v,{chart:{inverted:false}});v.series=w;return new g.Chart(v,t)}}(Highcharts));