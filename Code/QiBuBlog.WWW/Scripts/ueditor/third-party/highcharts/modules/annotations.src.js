(function(i,j){var p,a,b,d=i.Chart,h=i.extend,g=i.each;b=["path","rect","circle"];a={top:0,left:0,center:0.5,middle:0.5,bottom:1,right:1};var k=j.inArray,n=i.merge;function e(s){var r,q;q={xAxis:0,yAxis:0,title:{style:{},text:"",x:0,y:0},shape:{params:{stroke:"#000000",fill:"transparent",strokeWidth:2}}};r={circle:{params:{x:0,y:0}}};if(r[s]){q.shape=n(q.shape,r[s])}return q}function l(q){return Object.prototype.toString.call(q)==="[object Array]"}function m(q){return typeof q==="number"}function f(q){return q!==p&&q!==null}function o(q,t,v,u,w){var s=q.length,r=0;while(r<s){if(typeof q[r]==="number"&&typeof q[r+1]==="number"){q[r]=t.toPixels(q[r])-u;q[r+1]=v.toPixels(q[r+1])-w;r+=2}else{r+=1}}return q}var c=function(){this.init.apply(this,arguments)};c.prototype={init:function(q,r){var s=r.shape&&r.shape.type;this.chart=q;this.options=n({},e(s),r)},render:function(u){var q=this,r=this.chart,v=q.chart.renderer,s=q.group,y=q.title,w=q.shape,t=q.options,z=t.title,x=t.shape;if(!s){s=q.group=v.g()}if(!w&&x&&k(x.type,b)!==-1){w=q.shape=v[t.shape.type](x.params);w.add(s)}if(!y&&z){y=q.title=v.label(z);y.add(s)}s.add(r.annotations.group);q.linkObjects();if(u!==false){q.redraw()}},redraw:function(){var A=this.options,t=this.chart,u=this.group,G=this.title,E=this.shape,w=this.linkedObject,J=t.xAxis[A.xAxis],L=t.yAxis[A.yAxis],H=A.width,v=A.height,r=a[A.anchorY],q=a[A.anchorX],C=false,F,z,D,B,s,I,K;if(w){z=(w instanceof i.Point)?"point":(w instanceof i.Series)?"series":null;if(z==="point"){A.xValue=w.x;A.yValue=w.y;D=w.series}else{if(z==="series"){D=w}}if(u.visibility!==D.group.visibility){u.attr({visibility:D.group.visibility})}}I=(f(A.xValue)?J.toPixels(A.xValue+J.minPointOffset)-J.minPixelPadding:A.x);K=f(A.yValue)?L.toPixels(A.yValue):A.y;if(isNaN(I)||isNaN(K)||!m(I)||!m(K)){return}if(G){G.attr(A.title);G.css(A.title.style);C=true}if(E){F=h({},A.shape.params);if(A.units==="values"){for(B in F){if(k(B,["width","x"])>-1){F[B]=J.translate(F[B])}else{if(k(B,["height","y"])>-1){F[B]=L.translate(F[B])}}}if(F.width){F.width-=J.toPixels(0)-J.left}if(F.x){F.x+=J.minPixelPadding}if(A.shape.type==="path"){o(F.d,J,L,I,K)}}if(A.shape.type==="circle"){F.x+=F.r;F.y+=F.r}C=true;E.attr(F)}u.bBox=null;if(!m(H)){s=u.getBBox();H=s.width}if(!m(v)){if(!s){s=u.getBBox()}v=s.height}if(!m(q)){q=a.center}if(!m(r)){r=a.center}I=I-H*q;K=K-v*r;if(t.animation&&f(u.translateX)&&f(u.translateY)){u.animate({translateX:I,translateY:K})}else{u.translate(I,K)}},destroy:function(){var r=this,s=this.chart,q=s.annotations.allItems,t=q.indexOf(r);if(t>-1){q.splice(t,1)}g(["title","shape","group"],function(u){if(r[u]){r[u].destroy();r[u]=null}});r.group=r.title=r.shape=r.chart=r.options=null},update:function(q,r){h(this.options,q);this.linkObjects();this.render(r)},linkObjects:function(){var q=this,r=q.chart,u=q.linkedObject,t=u&&(u.id||u.options.id),v=q.options,s=v.linkedTo;if(!f(s)){q.linkedObject=null}else{if(!f(u)||s!==t){q.linkedObject=r.get(s)}}}};h(d.prototype,{annotations:{add:function(u,v){var q=this.allItems,r=this.chart,s,t;if(!l(u)){u=[u]}t=u.length;while(t--){s=new c(r,u[t]);q.push(s);s.render(v)}},redraw:function(){g(this.allItems,function(q){q.redraw()})}}});d.prototype.callbacks.push(function(q){var s=q.options.annotations,r;r=q.renderer.g("annotations");r.attr({zIndex:7});r.add();q.annotations.allItems=[];q.annotations.chart=q;q.annotations.group=r;if(l(s)&&s.length>0){q.annotations.add(q.options.annotations)}i.addEvent(q,"redraw",function(){q.annotations.redraw()})})}(Highcharts,HighchartsAdapter));